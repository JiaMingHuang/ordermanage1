<div class="panel panel-default">
    <div class="panel-heading">账户信息管理</div>

    <div class="panel-body">
        <div class="form-group">
            <label>用户名：</label>
            <input class="form-control" name="userid">
        </div>
        <button id="user-query" type="button" class="btn btn-primary">查询</button>
        <button id="toUserAdd" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
            新增用户
        </button>
    </div>
    <div class="panel-heading">账户信息列表</div>
    <div class="panel-body">
        <table width="100%" class="table table-striped table-bordered table-hover" id="user-main-list">
            <thead>
            <tr>
                <th>序号</th>
                <th>用户名</th>
                <th>用户类型</th>
                <th>联系电话</th>
                <th>负责人名称</th>
                <th>公司名称</th>
                <th>地址</th>
                <th>创建时间</th>
                <th>更新时间</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody id="user-main-list-tbody"></tbody>
        </table>
    </div>

    <script>
        $("#toUserAdd").click(function () {
            $(".modal-content").load("/user/add");
        });
        $(document).ready(function() {
            $("#user-main-list").DataTable({
                responsive: true
            });
        });
        $("#user-query").click(function () {

            var user = {
                userid:$("input[name='userid']").val(),
            };
            $.ajax({
                type: "POST",
                data: user,
                url: `/users/query`,
                async: true,
                context: document.body,
                success: function (data) {
                    let _dom;
                    data.forEach((val, index, data) => {
                        _dom += `
                        <tr>
                            <td>${val.id}</td>
                            <td>${val.userid}</td>
                            <td>${val.accounttype}</td>
                            <td>${val.contact}</td>
                            <td>${val.managername}</td>
                            <td>${val.companyname}</td>
                            <td>${val.address}</td>
                            <td>${val.createdate}</td>
                            <td>${val.updatedate}</td>
                            <td>
                                <p class="fa fa-edit"></p>
                                <p class="fa fa-trash-o" rel="/users/${val.id}" "></p>
                            </td>
                         </tr>
                        `;
                        $("#user-main-list-tbody").replaceWith("<tbody id=\"user-main-list-tbody\">"+ _dom +"</tbody>");
                    });
                }
            });
        });
    </script>
</div>
